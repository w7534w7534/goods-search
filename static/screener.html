<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自訂多空選股器 - 台股資訊查詢工具</title>
    <!-- 引入共用樣式與字體 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/screener.css">
</head>

<body>
    <!-- Toast 通知 -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- 頂部導覽列 -->
    <header class="header">
        <div class="header-container">
            <div class="logo-area">
                <div class="logo-icon">📈</div>
                <div class="logo-text">專業多空選股系統 <span>Pro Screener</span></div>
            </div>
            <div class="header-nav">
                <button id="themeToggleBtn" class="theme-toggle-btn">
                    <span class="icon">☀️</span> 淺色模式
                </button>
                <a href="/" class="btn-home"><span class="icon">🏠</span> 回到首頁</a>
            </div>
        </div>
    </header>

    <div class="container screener-main-container">
        <div class="screener-layout">
            <!-- 左側：自選股名單 -->
            <div class="glass-card watchlist-card">
                <div class="card-title">
                    <span class="icon">⭐</span> 我的自選名單 (Watchlist)
                </div>

                <div class="input-group">
                    <textarea id="addWatchlistInput"
                        placeholder="輸入代號，可一次貼上或分行輸入&#10;範例：2330 2317 或 2330,2317"></textarea>
                    <button id="addWatchlistBtn">批量加入</button>
                </div>

                <div class="hint-text">
                    💡 支援空白、逗號或換行分隔多檔股票
                </div>

                <div id="watchlistContainer">
                    <!-- JS 動態生成 -->
                </div>
            </div>

            <!-- 右側：主內容區 (選股條件 + 類股掃描) -->
            <div class="right-column">
                <!-- 分析類股區塊 -->
                <div class="glass-card sector-scan-card">
                    <div class="card-title">
                        <span class="icon">🏷️</span> 依類股批次掃描
                    </div>
                    <div class="input-group">
                        <select id="sectorSelect">
                            <option value="">載入中...</option>
                        </select>
                        <button id="scanSectorBtn" class="btn-scan">開始類股掃描 🚀</button>
                    </div>
                    <div class="sector-hint">
                        💡 選擇類股並搭配下方條件過濾
                    </div>
                </div>

                <!-- 右側：選股條件與結果 -->
                <div class="glass-card">
                    <div class="card-title">
                        <span class="icon">🎯</span> 多空條件過濾
                    </div>

                    <div id="filterForm">
                        <div class="filter-section">
                            <div class="filter-title"><span class="icon">🐂</span> 做多條件 (Bullish Signals)</div>
                            <div class="filter-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="condition" value="price_above_ma20">
                                    <div>
                                        <div class="condition-name">股價站上月線 (MA20)</div>
                                        <div class="condition-desc">收盤價大於 20 日移動平均線，代表中期趨勢偏多。</div>
                                    </div>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="condition" value="kd_golden_cross">
                                    <div>
                                        <div class="condition-name">KD 黃金交叉</div>
                                        <div class="condition-desc">K 值由下往上突破 D 值，為短線動能轉強訊號。</div>
                                    </div>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="condition" value="macd_histogram_positive">
                                    <div>
                                        <div class="condition-name">MACD 柱狀體翻紅</div>
                                        <div class="condition-desc">MACD 柱狀體由負轉正，表示多方力道開始增強。</div>
                                    </div>
                                </label>
                                <label class="checkbox-label full-width">
                                    <input type="checkbox" name="condition" value="macd_golden_cross">
                                    <div>
                                        <div class="condition-name">MACD 金叉</div>
                                        <div class="condition-desc">DIF (短軸) 逐漸由下往上穿過 DEA (慢線)，波段轉強。</div>
                                    </div>
                                </label>
                                <label class="checkbox-label full-width">
                                    <input type="checkbox" name="condition" value="macd_entanglement">
                                    <div>
                                        <div class="condition-name">MACD 糾纏 (準備表態)</div>
                                        <div class="condition-desc">近 4 日內 DIF 與 DEA 緊密貼合，籌碼沉澱完畢即將發動。</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="filter-section">
                            <div class="filter-title"><span class="icon">🐻</span> 做空條件 (Bearish Signals)</div>
                            <div class="filter-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="condition" value="price_below_ma20">
                                    <div>
                                        <div class="condition-name">股價跌破月線 (MA20)</div>
                                        <div class="condition-desc">收盤價小於 20 日移動平均線，中期趨勢可能轉弱。</div>
                                    </div>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="condition" value="kd_death_cross">
                                    <div>
                                        <div class="condition-name">KD 死亡交叉</div>
                                        <div class="condition-desc">K 值由上往下跌破 D 值，短線動能轉弱訊號。</div>
                                    </div>
                                </label>
                            </div>
                            <div class="filter-section chip-section">
                                <div class="filter-title"><span class="icon">💰</span> 籌碼面分析 (Chip Signals)</div>
                                <div class="filter-grid">
                                    <label class="checkbox-label full-width">
                                        <input type="checkbox" name="condition" value="chip_golden_cross">
                                        <div>
                                            <div class="condition-name" style="color:var(--accent-red)">🔥 籌碼黃金交叉 (底部吃貨)
                                            </div>
                                            <div class="condition-desc">大戶持股比例上升、散戶持股比例下降，籌碼流向少數特定人。</div>
                                        </div>
                                    </label>
                                    <label class="checkbox-label full-width">
                                        <input type="checkbox" name="condition" value="chip_death_cross">
                                        <div>
                                            <div class="condition-name" style="color:var(--accent-green)">💀 籌碼死亡交叉
                                                (高檔出貨)</div>
                                            <div class="condition-desc">大戶持股比例下降、散戶持股比例上升，散戶正在接刀。</div>
                                        </div>
                                    </label>
                                    <label class="checkbox-label full-width">
                                        <input type="checkbox" name="condition" value="chip_divergence">
                                        <div>
                                            <div class="condition-name" style="color:#d97706">⚠️ 高檔籌碼背離</div>
                                            <div class="condition-desc">股價處於月線之上，但大戶持股比例卻出現下滑，有拉高出貨疑慮。</div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                        </div>

                        <div class="scan-actions">
                            <button class="btn-scan" id="startScanBtn">開始掃描我的自選股 🚀</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 掃描結果區塊 -->
            <div class="glass-card result-card" id="resultContainer" style="display: none;">
                <div class="card-title result-card-title">
                    <span class="icon">📋</span> 掃描結果 (<span id="resultCount">0</span> 檔符合條件)
                </div>
                <div class="table-wrapper">
                    <table class="data-table" id="resultTable">
                        <thead>
                            <tr>
                                <th>股票代碼</th>
                                <th>名稱</th>
                                <th class="text-right">最新收盤價</th>
                                <th class="text-right">月線(MA20)</th>
                                <th class="text-center">KD 狀態</th>
                                <th class="text-center">籌碼情境</th>
                                <th class="text-center">操作</th>
                            </tr>
                        </thead>
                        <tbody id="resultBody">
                            <!-- JS 動態生成 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 背景特效 -->
        <div class="glow glow-1"></div>
        <div class="glow glow-2"></div>

        <script src="/js/common.js"></script>
        <script src="/js/api.js"></script>
        <script src="/js/watchlist.js"></script>
        <script src="/js/screener.js"></script>
</body>

</html>